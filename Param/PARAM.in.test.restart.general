#ECHO
T

#SESSION
general

#DESCRIPTION
Short coupling test for IH-GM-IM-IE-UA. Restart. Needs user_routines.f90.heliosphere.

#PLANET
EARTH                         NamePlanet

#STARTTIME
    2002                            year
      10                           month
       1                             day
       0                            hour
       0                          minute
       0                          second
 0.000000000000               FracSecond

! This is a restart from a 2000-step steady state run

#NSTEP
    2000                           nStep

#TIMESIMULATION
 0.00000000E+00              tSimulation

#VERSION
 0.90                        VersionSwmf

#PRECISION
8                              nByteReal


#IDEALAXES
! Align rotational and magnetic axes with Z_GSE

#TIMEACCURATE
T

#SAVERESTART
F

#COUPLE2
GM			NameComp1
IE			NameComp2
-1                      DnCouple
10.                     DtCouple

#COUPLE2
UA			NameComp1
IE			NameComp2
-1                      DnCouple
10.                     DtCouple

#COUPLE2
IM			NameComp1
GM			NameComp2
-1                     DnCouple
35.                     DtCouple

#COUPLE1
IE			NameSource
IM			NameTarget
-1                     DnCouple
35.                     DtCouple

#COUPLE1
IH			NameSource
GM			NameTarget
-1			DnCouple
10.			DtCouple

#BEGIN_COMP IH ############################################

#INCLUDE
IH/restartIN/restart.H

#HELIOSPHERE
2.85E+06		tSun  [K]
1.50E+14		NdSun [n/m-3]
25.00			qSun
1.75			tHeat
1.00			rHeat
4.50			SigmaHeat
F                       UseUserPerturbation

#HELIODIPOLE
-3.0E00			HelioDipoleStrength(equatorial field strength in Gauss)
0.0			HelioDipoleTilt

#HELIOTEST
T                       DoSendMHD, replace IH with IMF.dat when false

! We use the extra source terms and inner boundary conditions defined
! in user_routines.f90.heliosphere

#USER_FLAGS
T                       UseUserInnerBcs
T                       UseUserSource
F                       UseUserPerturbation
F                       UseUserOuterBcs
F                       UseUserICs
F                       UseUserSpecifyRefinement
F                       UseUserLogFiles
F                       UseUserWritePlot
F                       UseUserAMR
F                       UseUserEchoInput
F                       UseUserB0
F                       UseUserSetPhysConst
F                       UseUserUpdateStates

#USERINPUTBEGIN

#USEUSERHEATING
T

#USERINPUTEND

#OUTERBOUNDARY
float			TypeOuterBC(east_)
float			TypeOuterBC(west_)
float			TypeOuterBC(south_) 
float			TypeOuterBC(north_) 
float			TypeOuterBC(bot_)  
float			TypeOuterBC(top_) 

#TIMESTEPPING
2			nStage
0.8			CflExpl

#SCHEME
2			nOrder
Linde			TypeFlux
minmod			TypeLimiter

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.			DtSaveLogfile

#SAVEPLOT
3                       nPlotFiles
x=0 MHD idl             StringPlot
-1                      DnSavePlot
60.			DtSavePlot
-1.			Dx
y=0 MHD idl             StringPlot
-1                      DnSavePlot
10.			DtSavePlot
-1.			Dx
z=0 MHD idl             StringPlot
-1                      DnSavePlot
60.			DtSavePlot
-1.			Dx

#END_COMP IH   ############################################

#BEGIN_COMP GM ############################################

#TEST
ray_trace

#INCLUDE
GM/restartIN/restart.H

#OUTERBOUNDARY
outflow			east
coupled			west
float			south
float			north
float			bottom
float			top

#TIMESTEPPING
1			nSTAGE                 (default is 1 stage)
0.65			cfl                    (default is 0.8)

#BORIS
T                       UseBorisCorrection
0.005                   BorisClightFactor

#IM
0.1                     TauCoupleIm

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.			DtSaveLogfile

#SAVEPLOT
2                       nPlotFiles
y=0 MHD idl             StringPlot
-1                      DnSavePlot
10.			DtSavePlot
-1.			Dx
z=0 MHD idl             StringPlot
-1                      DnSavePlot
10.			DtSavePlot
-1.			Dx

#SAVEBINARY
T

#END_COMP GM ##########################################################

#BEGIN_COMP UA ########################################################

#DEBUG
0
0

#RESTART
F

! Each block has 18x18 lon and lat cells
! which corresponsd to a 20 by 10 degrees
! resolution with 4 by 2 blocks:

#GRID
4		nLatBlock
2		nLonBlock

#PRESSURE
F
95.0
500.0

#FORCING
F		UsePressureGradient (logical)
T		UseIonDrag          (logical)
F		UseViscosity        (logical)
F		UseCoriolis         (logical)
F		UseHorAdvection     (logical)
F		UseVerAdvection     (logical)
F		UseVForce           (logical)

#APEX
F

#AMIEFILES
SPS
SPS

#F107
150.0
150.0

#HPI
20.0

#KP
2.0

#SOLARWIND
0.0
0.1
-3.0
400.0

#DT
10.0

#SAVEPLOTS
10
360
2
3DALL
2D

#STRETCH
65.0		! location of minimum grid spacing
0.0		! Amount of stretch 0 (none) to 1 (lots)
1.0		! More control of stretch ( > 1 stretch less < 1 stretch more)

#END_COMP UA   ########################################################

#BEGIN_COMP IE ########################################################

#IONOSPHERE
5                       conductance_model
F                       UseFullCurrent
F			UseFakeRegion2
150.0                   f107_flux
0.2                     StarLightPedConductance
0.5                     PolarCapPedConductance

#IE_SAVEPLOT
1			nFile
min idl			StringPlot
-1			DnOutput
5.			DtOutput

#SPS
T

#DEBUG
0
0

#END_COMP IE ##########################################################

#STOP
-1
60.

#END
