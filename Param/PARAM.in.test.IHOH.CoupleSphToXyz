#COMPONENTMAP
IH  0 -1  1		IH runs on all PEs
OH  0 -1  1		OH runs on all PEs

#DESCRIPTION
launch a blob in IH, advect to OH, calculate error

#SAVERESTART
F			DoSaveRestart

#TEST
OH_fill_buffer_only

#BEGIN_COMP IH --------------------------------------------------------------

#COORDSYSTEM
HGI                     TypeCoordSystem

#GRAVITY
F                       UseGravity (rest of parameters read if true)
0                       iDirGravity(0 - central, 1 - X, 2 - Y, 3 - Z direction)

#BODY
T                       UseBody
50.0                    rBody (Rs)
1.00e3                  BodyNDim(1) [/cc] number density for ions
1.00E5                  BodyTDim(1) [K] temperature for ions

#BODY
F			UseBody

#USERFLAGS
F                       UseUserInnerBcs
F                       UseUserSource
F                       UseUserPerturbation
F                       UseUserOuterBcs
T                       UseUserICs
F                       UseUserSpecifyRefinement
F                       UseUserLogFiles
T                       UseUserWritePlot
F                       UseUserAMR
F                       UseUserEchoInput
F                       UseUserB0
F                       UseUserInitSession
F                       UseUserUpdateStates

#USERINPUTBEGIN -----------------------------------------------------------

#USERPROBLEM
AdvectSphere

#USERINPUTUNITX
T
rSun

#ADVECTSPHERE
T			DoInitSphere
1.0e3			NumDensBackgrndIo
.00001	        	pBackgrndIo
20000.0			uBackgrndIo
90.0			FlowAngleTheta (Deg)
0.0			FlowAnglePhi (Deg)
400.0			rSphere  (Rs)
3.5e3			NumDensSphereIo
550.0			xSphereCenterInitIo
0.0			ySphereCenterInitIo
0.0			zSphereCenterInitIo

#ANALYTIC
T

#USERINPUTEND -------------------------------------------------------------

#OUTERBOUNDARY
float			TypeBcXMin
float    		TypeBcXMax
float			TypeBcYMin
float			TypeBcYMax
float			TypeBcZMin
float			TypeBzZMax

#GRIDGEOMETRY
spherical		TypeGeometry

Allow resolution change around the axis
#UNIFORMAXIS
F			UseUniformAxis

#GRID
1                     	nRootBlockX
2                     	nRootBlockY
1                     	nRootBlockZ
-1290.0	                xMin
 2600.0                 xMax
-1290.0                 yMin
 1290.0                 yMax
-1290.0                 zMin
 1290.0                 zMax

#LIMITRADIUS
50.			rMin
2580.			rMax

#GRIDLEVEL
3			nLevelArea
initial			NameArea

#GRIDLEVEL
1                       nLevelArea
all                     NameArea

#GRIDLEVEL
3			nLevelIh
box_gen			NameArea
50.0			xMinBox
320.			yMinBox
-40.			zMinBox
2600.			xMaxBox
360.			yMaxBox
40.			zMaxBox

#GRIDLEVEL
3			nLevelIh
box_gen			NameArea
50.0			xMinBox
0.			yMinBox
-40.			zMinBox
2600.			xMaxBox
40.			yMaxBox
40.			zMaxBox

#TIMESTEPPING
2			nStage
0.8			CflExpl

#SCHEME
2			nOrder
Rusanov			TypeFlux
mc			TypeLimiter
2.0			BetaLimiter

#SAVEINITIAL
T			DoSaveInitial

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
-1			DnSaveLogfile
1.			DtSaveLogfile

#SAVEPLOT
1			nPlotFiles
z=0 VAR idl		StringOutput
-1			DnOutput
350.			DtOutput
-1.			DxOutput
rho ux uy uz mach p rhoexact rhoerr
g rbody

#END_COMP IH -----------------------------------------------------------------

#BEGIN_COMP OH ---------------------------------------------------------------

#COORDSYSTEM
HGI			NameCoordSystem

#BODY
T                       UseBody
3.0                     rBody (AU)
1.00e3                  BodyNDim [/cc] number density for ions
1.00E5                  BodyTDim [K] temperature for ions

#BODY
F			UseBody

#GRAVITY
F                       UseGravity (rest of parameters read if true)
0                       iDirGravity(0 - central, 1 - X, 2 - Y, 3 - Z direction)

#USERFLAGS
F                       UseUserInnerBcs
F                       UseUserSource
F                       UseUserPerturbation
F                       UseUserOuterBcs
T                       UseUserICs
F                       UseUserSpecifyRefinement
F                       UseUserLogFiles
T                       UseUserWritePlot
F                       UseUserAMR
F                       UseUserEchoInput
F                       UseUserB0
F                       UseUserInitSession
F                       UseUserUpdateStates

#USERINPUTBEGIN --------------------------------------------------------

#USERPROBLEM
AdvectSphere

#USERINPUTUNITX
T
rSun

#ADVECTSPHERE
F			DoInitSphere
1.0e3			NumDensBackgrndIo
.00001	        	pBackgrndIo
20000.0			uBackgrndIo
90.0			FlowAngleTheta (Deg)
0.0			FlowAnglePhi   (Deg)
400.0			rSphere  (Rs)
3.5e3			NumDensSphereIo
550.0			xSphereCenterInitIo
0.0			ySphereCenterInitIo
0.0			zSphereCenterInitIo

#ANALYTIC
T

#USERINPUTEND ----------------------------------------------------------

#GRID
1			nRootBlockX
1			nRootBlockY
1			nRootBlockZ
-7.			xMin
12.			xMax
-7.			yMin
7.			yMax
-7.			zMin
7.			zMax

#GRIDLEVEL
3			nLevelArea
initial			NameArea

#GRIDLEVEL
1			nLevelArea
all			NameArea

#GRIDLEVEL
3			nLevelArea
box			NameArea
0.			xMinBox
-3.			yMinBox
-3.			zMinBox
12.			xMaxBox
3.			yMaxBox
3.			zMaxBox

#INNERBOUNDARY
buffergrid		TypeBcInner

#BUFFERGRID
2			nRBuff
90			nPhiBuff
45			nThetaBuff
4.0			rBuffMin
5.2			rBuffMax
0.0			PhiBuffMin
360.			PhiBuffMax
-90.			LatBuffMin
90.			LatBuffMax

#OUTERBOUNDARY
float			TypeBcXMin
float    		TypeBcXMax
float			TypeBcYMin
float			TypeBcYMax
float			TypeBcZMin
float			TypeBzZMax

#SCHEME
2			nOrder
Rusanov			TypeFlux
mc			TypeLimiter
2.0			BetaLimiter

#TIMESTEPPING
2                       nStage
0.80                    CflExpl

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.			DtSaveLogfile

#SAVEINITIAL
T			DoSaveInitial

#SAVEPLOT
1			nPlotFile
z=0 VAR idl		StringPlot
-1			DnOutput
350.	        	DtOutput
-1.			DxOutput
rho ux uy uz mach p rhoexact rhoerr
g rbody

#END_COMP OH -----------------------------------------------------------

#COUPLE1
IH			NameSource
OH			NameTarget
-1			DnCouple
70.			DtCouple

#STOP
-1			MaxIteration
50000.0			tSimulationMax
