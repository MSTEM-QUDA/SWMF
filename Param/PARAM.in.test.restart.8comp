#ECHO
T

#DESCRIPTION
Restart SC-IH-GM-IE in time accurate mode.

#INCLUDE
RESTART.in

#IDEALAXES
! align both the rotational and the magnetic axes of Earth with ecliptic North

#TIMEACCURATE
T			DoTimeAccurate

#SAVERESTART
F			DoSaveRestart

#COUPLEORDER
11			nCouple
SC IH			NameSourceTarget
IH SC			NameSourceTarget
IH GM			NameSourceTarget
IE GM			NameSourceTarget
IE IM                   NameSourceTarget
IE UA			NameSourceTarget
UA IE			NameSourceTarget
GM IE                   NameSourceTarget
GM IM                   NameSourceTarget
GM RB                   NameSourceTarget
IM GM                   NameSourceTarget

#BEGIN_COMP SC --------------------------------------------------------------

#INCLUDE
SC/restartIN/restart.H

#USER_FLAGS
T			UseUserInnerBCs
F			UseUserSource
T			UseUserPerturbation
F			UseUserOuterBcs
F			UseUserICs
F			UseUserSpecifyRefinement
T			UseUserLogFiles
F			UseUserWritePlot
F			UseUserAMR
F			UseUserEchoInput
T			UseUserB0
F			UseUserSetPhysConst
T			UseUserUpdateStates

#USERINPUTBEGIN ------------------------

#USEUSERHEATING
F			UseUserHeating

#PFSSM
T			UseUserB0
1.00E+00		Ro_PFSSM
2.50E+00		Rs_PFSSM
SC/CR1935_WSO.dat       File_PFSSM
12			iHead_PFSSM
-1.00E+00		dt_UpdateB0

#AWHEAT
1.50E+00		Bnot	[G]
1.6304543E+00		Tnot
9			DegFrm1
2.10E+00		TemRatio
F     			UseStaticICs
F                       UseZeroOmega

#USERINPUTEND ----------------------------

#HELIOSPHERE
1.80E+06		tSun    [K]      1.0E6 
5.00E+13		NdSun [n/m-3]
10.00			qSun
1.76			tHeat
1.00			rHeat
4.50			SigmaHeat
T			UseFluxRope
0.73			CmeA
1.75			CmeR1
0.35			CmeR0
-10.00			CmeA1
0.0			CmeAlpha
0.0			CmeRho1
0.0			CmeRho2
1.0			ModulationRho
1.0			ModulationP
2.40E+01		cRotXGl98
0.00E+00		cRotYGl98
9.00E+01		cRotZGl98

#HELIOROTATION
T			UseInertial, if false then corotating frame
F			UseCorotation

#GAMMA
1.50000E+00		Gamma

#OUTERBOUNDARY
coupled 		TypeBcEast
coupled 		TypeBcWest
coupled 		TypeBcSouth
coupled 		TypeBcNorth
coupled 		TypeBcBottom
coupled 		TypeBcTop

#SCHEME
2			nOrder (1 or 2)
Sokolov			TypeFlux (Roe, Rusanov, Linde, Sokolov)
minmod			TypeLimiter

#TIMESTEPPING
1                       nStage
0.80                    CflExpl

#SAVELOGFILE
T                       DoSaveLogfile
VAR                     StringLog
-1                      DnSaveLogfile
60.0			DtSaveLogfile
em_r ek_r et_r
4.0  10.0               rLog

#SAVEPLOT
4			nPlotFiles
x=0 MHD tec             StringPlot
-1                      DnSavePlot
300.0			DtSavePlot
y=0 MHD tec		StringPlot
-1			DnSavePlot
300.0			DtSavePlot
z=0 MHD tec		StringPlot
-1			DnSavePlot
300.0			DtSavePlot
y=0 MHD idl             StringPlot
-1                      DnSavePlot
300.			DtSavePlot
-1.			DxSavePlot

#END_COMP SC ----------------------------------------------------------------

#COUPLE2
SC			NameSource
IH			NameTarget
-1			DnCouple
60.			DtCouple

#BEGIN_COMP IH ---------------------------------------------------------------

#INCLUDE
IH/restartIN/restart.H

#INNERBOUNDARY
coronatoih		TypeBcInner

#HELIOSPHERE
2.85E+06		BodyTDim   [K] 
1.50E+14		BodyRhoDim [n/m-3]
25.00			qSun
1.75			tHeat
1.00			rHeat
4.50			SigmaHeat
F                       UseUserPerturbation

#HELIODIPOLE
0.0			HelioDipoleStrength(equatorial field strength in Gauss)
0.0			HelioDipoleTilt

#HELIOUPDATEB0
-1.0			DtUpdateB0

#OUTERBOUNDARY
heliofloat		TypeBcEast
heliofloat		TypeBcWest
heliofloat		TypeBcSouth
heliofloat		TypeBcNorth
heliofloat		TypeBcBottom
heliofloat		TypeBcTop 

#FACEOUTERBC
6			MaxBoundary
F			DoFixOuterBoundary

#AMRINIT
coupledhelio    	TypeRefineInit
6			nLevelRefineInit

#TIMESTEPPING
2			nStage
0.8			CflExpl

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
-1			DnSaveLogfile
60.			DtSaveLogfile

#SAVEPLOT
2                       nPlotFiles
x=0 MHD tec             StringPlot
-1                      DnSavePlot
300.0			DtSavePlot
y=0 MHD idl             StringPlot
-1                      DnSavePlot
300.0			DtSavePlot
-1.			DxSavePlot

#GAMMA
1.50000E+00		Gamma

#SCHEME
2			nOrder
Sokolov			TypeFlux
minmod                  TypeLimiter

#END_COMP IH -----------------------------------------------------------------

#COUPLE1
IH			NameSource
GM			NameTarget
-1			DnCouple
60.			DtCouple

#BEGIN_COMP GM ---------------------------------------------------------------

#INCLUDE
GM/restartIN/restart.H

#AMRINIT
magneto12		TypeRefineInit
6			nRefineLevelInit

#OUTERBOUNDARY
outflow			TypeBcEast
coupled			TypeBcWest
float			TypeBcSouth
float			TypeBcNorth
float			TypeBcBottom
float			TypeBcTop

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.0			DtSaveLogfile

#SAVEPLOT
3			nPlotFiles
x=0 MHD idl		StringPlot
-1			DnSavePlot
300.0			DtSavePlot
-1.			DxSavePlot
y=0 MHD idl		StringPlot
-1			DnSavePlot
300.0			DtSavePlot
-1.			DxSavePlot
z=0 MHD idl		StringPlot
-1			DnSavePlot
300.0			DtSavePlot
-1.			DxSavePlot

#TIMESTEPPING
2			nStage
0.8			CflExpl

#SCHEME
2			nOrder
Rusanov			TypeFlux
minmod			TypeLimiter

#AMRRESOLUTION
0.25			DxCellMin
8.0			DxCellMax
T			DoFixBodyLevel

#AMR
150			DnRefine
T			DoAutoRefine
15.			PercentCoarsen
15.			PercentRefine
2500			MaxTotalBlocks

#AMRCRITERIA
2			nRefineCrit
gradlogP		TypeRefine
curlB			TypeRefine

#MESSAGEPASS
opt			TypeMessagePass

#FIXEDTIMESTEP
T			DoFixTimeStep
4.0			DtFixedDim

#IMPLICIT
F			UsePointImplicit
T			UsePartImplicit
F			UseFullImplicit
100.0			CflImpl

#END_COMP GM -------------------------------------------------------------

!For sake of efficiency do not synchronize GM time
COUPLETIME
GM			NameComp
F			DoCoupleOnTime

! Since GM does 4s time steps, it is good to use multiples of that

#COUPLE2
GM			NameSource
IE			NameTarget
-1			DnCouple
 8.			DtCouple

#COUPLE2
UA			NameComp1
IE			NameComp2
-1                      DnCouple
40.                     DtCouple

#COUPLE1
IE			NameSource
IM			NameTarget
-1                      DnCouple
40.                     DtCouple

#COUPLE2
IM			NameComp1
GM			NameComp2
-1                      DnCouple
40.                     DtCouple

#COUPLE1
GM			NameSource
RB			NameTarget
-1                      DnCouple
3600.                   DtCouple

#BEGIN_COMP IM ---------------------------------------------------------------

#RESTART
T			DoRestart

#END_COMP IM   ---------------------------------------------------------------

#BEGIN_COMP IE ---------------------------------------------------------------

#IONOSPHERE
5			conductance_model
F			UseFullCurrent
F			UseFakeRegion2
150.0			F10.7 Flux
0.2			StarLightPedConductance
0.5			PolarCapPedConductance

#SAVEPLOT
1			nFile
min idl			plot_string
-1			dn_output
300.0			dt_output

#SPS
T			UseSps (this is the serial potential solver)

#END_COMP IE -----------------------------------------------------------------

#BEGIN_COMP UA ---------------------------------------------------------------

#RESTART
T

! Each block has 18x18 lon and lat cells, and we use 4 by 2 blocks
! which corresponsd to a 20 by 10 degrees resolution:

#GRID
8		nLonBlock
4		nLatBlock

#PRESSURE
F		PressureCoordinates
95.0		BaseAlt [km]
500.0		dz [km]

#FORCING
F		UsePressureGradient (logical)
T		UseIonDrag          (logical)
F		UseViscosity        (logical)
F		UseCoriolis         (logical)
F		UseHorAdvection     (logical)
F		UseVerAdvection     (logical)
F		UseVForce           (logical)

#APEX
F		UseApex

#AMIEFILES
SPS
SPS

#F107
150.0
150.0

#HPI
20.0

#KP
2.0

#SOLARWIND
 1.224			SwBxDim  [nT]
-0.2			SwByDim  [nT]
+0.744			SwBzDim  [nT]
461.0			abs(SwUxDim) [km/s]

#DT
10.0			dT [s]

#SAVEPLOTS
10			dnOutput
-1			dnRestart
1			nOutputTypes
2D			TypeOutput

#STRETCH
65.0		! location of minimum grid spacing
0.0		! Amount of stretch 0 (none) to 1 (lots)
1.0		! More control of stretch ( > 1 stretch less < 1 stretch more)

#END_COMP UA   ########################################################

#STOP
-1                    MaxIteration
300.0                 tSimulationMax

#END
