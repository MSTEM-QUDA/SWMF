#COMPONENTMAP
OH       0   -1    1   ! OH runs on all PE-s
PT       1    2    1   ! PT runs on 1 or 2 PE-s

#DESCRIPTION
Param/PARAM.in.test.OHPT: Couple single-ion OH with PT

#TIMEACCURATE           
F  			IsTimeAccurate

#BEGIN_COMP OH ===========================================================

#GRAVITY
F                       UseGravity (rest of parameters read if true)
0                       iDirGravity(0 - central, 1 - X, 2 - Y, 3 - Z direction)

#BODY
T                       UseBody
30.0                    rBody (AU)
0.01                    BodyNDim(1) [/cc] number density for ions
1.09E5                  BodyTDim(1) [K] temperature for ions

#NORMALIZATION
USER

#PLOTFILENAME
year                   NameMaxTimeUnit

#GRID
1			nRootBlockX
1			nRootBlockY
1			nRootBlockZ
-1500.0			xMin
 1500.0			xMax
-1500.0			yMin
 1500.0			yMax
-1500.0			zMin
 1500.0			zMax


#GRIDBLOCKALL
3500			MaxBlock

#GRIDLEVEL
2			nLevelArea
all			NameArea

#GRIDLEVEL
5			nLevelArea (usually 11)
initial			NameArea

#GRIDLEVEL
11                      nLevel
shell0                  NameArea
30.0
30.2

#GRIDRESOLUTION
35.937			Resolution
box			NameArea  
0.0			xMinBox	  
-600.			yMinBox	  
-600.			zMinBox	  
-600.			xMaxBox	  
600.			yMaxBox	  
600.			zMaxBox   

#GRIDRESOLUTION
17.969			Resolution
box			NameArea  
-153.0			xMinBox	  
-340.0			yMinBox	  
-340.0			zMinBox	  
-600.0			xMaxBox	  
340.0			yMaxBox	  
340.0			zMaxBox   

#GRIDRESOLUTION
8.984			Resolution
box			NameArea  
-109.0			xMinBox	  
-200.0			yMinBox	  
-200.0			zMinBox	  
-400.0			xMaxBox	  
200.0			yMaxBox	  
200.0			zMaxBox   

#GRIDRESOLUTION
4.492			Resolution
box			NameArea  
-59.64			xMinBox	  
-136.0			yMinBox	  
-136.0			zMinBox	  
-272.0			xMaxBox	  
136.0			yMaxBox	  
136.0			zMaxBox   

#GRIDRESOLUTION
3.0			Resolution
box			NameArea  
-71.31			xMinBox	  
-85.0			yMinBox	  
-85.0			zMinBox	  
-170.0			xMaxBox	  
85.0			yMaxBox	  
85.0			zMaxBox   

#GRIDRESOLUTION
1.5			Resolution
box			NameArea  
-20.00			xMinBox	  
-42.0			yMinBox	  
-42.0			zMinBox	  
-68.0			xMaxBox	  
42.0			yMaxBox	  
42.0			zMaxBox   

#GRIDRESOLUTION
0.7			Resolution
box			NameArea  
-5.0			xMinBox	  
-40.0			yMinBox	  
-40.0			zMinBox	  
-40.0			xMaxBox	  
40.0			yMaxBox	  
40.0			zMaxBox   

#INNERBOUNDARY
user			TypeBcInner

#OUTERBOUNDARY
user			TypeBc1
outflow			TypeBc2
outflow			TypeBc3
outflow			TypeBc4
outflow			TypeBc5
outflow			TypeBc6

NEUTRALFLUID
F			DoConserveNeutrals
Linde			TypeFluxNeutral

#SCHEME
1			nOrder
Linde			TypeFlux

#TIMESTEPPING
1                       nStage (1 or 2)
0.80                    CflExpl

#NONCONSERVATIVE
T			UseNonConservative

#CONSERVATIVECRITERIA
0			nConsCrit

#SAVERESTART
T			DoSaveRestart 
1000			DoSaveRestart 
-1.0			DtSaveRestart

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.			DtSaveLogfile

#SAVEINITIAL
T			DoSaveInitial

#SAVEPLOT
2			nPlotFile
y=0 MHD idl		StringPlot
10			DnOutput
-1.0			DtOuput
-1.0			DxOutput
z=0 MHD idl		StringPlot
10			DnOutput
-1.0			DtOuput
-1.0			DxOutput

#USERSWITCH
+init +ic +progress	StringSwitch

#USERINPUTBEGIN --------------------------------------------------------

#SOLARWINDH
0.00874			SWH_N_dim [/cc]
1.0868E5       		SWH_T_dim [K] 
417.07                  SWH_Ux_dim [km/s]
0.0                     SWH_Uy_dim [km/s]
0.0                     SWH_Uz_dim [km/s]
7.17E-03                SWH_Bx_dim [nT]
0.0                     SWH_By_dim [nT]
0.0                     SWH_Bz_dim [nT]

#VLISW                  
0.06            	VLISW_N_dim [n/cc]
6519.0               	VLISW_T_dim
26.3               	VLISW_Ux_dim
0.0                	VLISW_Uy_dim
-2.3              	VLISW_Uz_dim
0.3093            	VLISW_Bx_dim
-0.080            	VLISW_By_dim
-0.2988           	VLISW_Bz_dim

#USERINPUTEND ----------------------------------------------------------

#END_COMP OH ===========================================================

#STOP
50			MaxIteration
-1.0			tSimulationMax

#RUN ####################################################################

#BEGIN_COMP OH ========================================================

#SCHEME
2			nOrder
Linde			TypeFlux
minmod			TypeLimiter

#END_COMP OH ==========================================================

#STOP
100			MaxIteration
-1.0			tSimulationMax

#RUN ###################################################################

#SAVERESTART
T                       DoSaveRestart
1000                    DnSaveRestart
-1.0                    DtSaveRestart

#BEGIN_COMP OH ========================================================

#USERSWITCH
+source_expl -progress		StringUserSwitch

#SCHEME
2                       nOrder
Roe                     TypeFlux
mc                      TypeLimiter
1.5                     LimiterBeta

! 0.8 works fine for higher resolution
#TIMESTEPPING
2                       nStage
0.4                     CflExpl 

! Applies to the ions only if DoConserveNeutrals is false in #MULTIFLUID
#NONCONSERVATIVE
F                       UseNonConservative

! Point implicit does not seem to help stability
POINTIMPLICIT
F                       UsePointImplicit
1.0                     BetaPointImplicit
T			IsAsymmetric
T			DoNormalizeCell

#USERINPUTBEGIN --------------------------------------------------------

#SOURCES
F                       UseIonSource
F                       UseNeuSource
F                       UseNe2Source
F                       UseNe3Source
F                       UseNe4Source

#USERINPUTEND ----------------------------------------------------------

#END_COMP OH ===========================================================

#COUPLE2
OH                      NameComp1
PT                      NameComp2
1                       DnCouple
-1.0                    DtCouple

#STOP
140			MaxIteration
-1.0			tSimulationMax

#RUN ###################################################################

#TIMEACCURATE
T			IsTimeAccurate

#SAVERESTART
T			DoSaveRestart 
-1			DoSaveRestart 
5.0			DtSaveRestart

#COUPLE2
OH			NameComp1
PT			NameComp2
-1			DnCouple
1.0			DtCouple

#STOP
-1			MaxIteration
3.0			tSimulationMax
