#ECHO
T			DoEcho

#DESCRIPTION
Input file for creating a steady state lower corona

#TIMEACCURATE
F			DoTimeAccurate

#STARTTIME
1998                    iYear
5                       iMonth
1                       iDay
0                       iHour
0                       iMinute
0                       iSecond
0.0                     FracSecond

#SAVERESTART
F			DoSaveRestart
2000			DnSaveRestart
-1.0			DtSaveRestart

#BEGIN_COMP LC --------------------------------------------------------------

#COORDSYSTEM
HGR                     TypeCoordSystem

#MAGNETOGRAM
T                       UseMagnetogram
1.0                     Ro_PFSSM
2.5                     Rs_PFSSM
0.0                     H_PFSSM
LC/Param/CR1935_WSO.dat
12                      iHead_PFSSM
-1.0                    PhiShift
0.01                    UnitB

#CORONALHEATING
exponential		TypeCoronalHeating
0.057471264		DecayLength
7.2847901E-05		HeatingAmplitudeCgs

#LONGSCALEHEATING
T			DoChHeat
5.0e-7			HeatChCgs
0.7			DecayCh

#ACTIVEREGIONHEATING
T			UseArComponent
4.03E-05		ArHeatFactor
30.0			ArHeatB0
5.0			ArHeatDeltaB0

#OPENCLOSEDHEAT
T			DoOpenClosedHeat

#RADIATIVECOOLING
T			UseRadiativeCooling

!--------User flags:
!-User Sources: limit the time step to account for a cooling function
! User Inner Bc: implements the BC "chromo"
#USER_FLAGS
T			UseUserInnerBcs
T			UseUserSource
T			UseUserPerturbation
F			UseUserOuterBcs
T			UseUserICs
T			UseUserSpecifyRefinement
T			UseUserLogFiles
F			UseUserWritePlot
F			UseUserAMR
F			UseUserEchoInput
F			UseUserB0
T			UseUserInitSession
F			UseUserUpdateStates

#USERINPUTBEGIN ------------------------

1. Excessive density, lower temperature in the chromosphere

#TRBOUNDARY
chromo			TypeTRBoundary
1.0E+12 		BoundaryNeCgs [1/cc]
2.0E+4			BoundaryTeSi [K]

#USERINPUTEND ----------------------------

2. Modify accordingly the radiative cooling and heat conduction

#CHROMOSPHERE
F			UseChromosphereHeating
1.0e+12			NumberDensChromosphereCgs
2.0e+4			TeChromosphereSi

#TRANSITIONREGION
T			DoModHeatConduction
3.0E+5			TeModSi
1.0E+1			DeltaTeModSi

#BODY
T			Usebody
1.0			rBody
1.5E+8			BodyNDim
3.0E+6			BodyTDim

#INNERBOUNDARY
user			TypeBcInner

#FACEBOUNDARY
-1			MinBoundary
-1			MaxBoundary

#PLASMA
1.0			MassFluid
1.0			AverageIonCharge
1.0			ElectronTemperatureRatio

#GAMMA
1.6666			Gamma

#OUTERBOUNDARY
user	                TypeBcEast
float   	        TypeBcWest
float	                TypeBcSouth
float	  		TypeBcNorth
float	 	        TypeBcBot
float	   		TypeBcTop

#GRIDGEOMETRY
spherical_genr		TypeGeometry
LC/Param/grid_TR.dat	NameGridFile

! Use a true sphere, so box is made much larger
#GRID
1			nRootBlockX
2			nRootBlockY
1			nRootBlockZ
-100.0			xMin
 100.0			xMax
-100.0			yMin
 100.0			yMax
-100.0			zMin
 100.0			zMax

#LIMITRADIUS
1.0			rMin
24.0			rMax

#GRIDLEVEL
2			nLevelArea
all			NameArea

#GRIDLEVEL
2			nLevelArea
box_gen			NameArea
1.0			rMin
0.0			LonMin
-65.0			LatMin
1.70			rMax
360.0			LonMax
65.0			LatMax

GRIDLEVEL
3			nLevelArea
user			NameArea

#GRIDLEVEL
2                       nLevelArea
initial                 NameArea

#FIXAXIS
F                       UsePoleDiffusion
T                       DoFixAxis
8.0                     rFixAxis
1.5                     r2FixAxis

#USECURLB0
T			UseCurlB0
2.5			rCurrentFreeB0

AMR
30			DnRefine
F			DoAutomaticRefinement 

#HEATCONDUCTION
T			UseHeatConduction
spitzer			TypeHeatConduction

#WEAKFIELDCONDUCTION
T			DoWeakFieldConduction
1.0E-7			BmodifySi
1.0E-8			DeltaBmodifySi

#MESSAGEPASS
all			TypeMessagePass

#SCHEME
2			nOrder (1 or 2)
Sokolov			TypeFlux (Roe, Rusanov, Linde, Sokolov
mc                      TypeLimiter
1.2			LimiterBeta

#TIMESTEPPING
2                       nStage
0.80                    CflExpl

!----Load table used for making synthetic EUV and X-ray images

#LOOKUPTABLE
euv			NameTable
load			NameCommand
LC/Param/los_Eit.dat	NameFile
ascii			TypeFile

#LOOKUPTABLE
sxr			NameTable
load			NameCommand
LC/Param/los_Sxt.dat	NameFile
ascii			TypeFile

!-----Load table used for calculating the radiative cooling

#LOOKUPTABLE
radcool			NameTable
load			NameCommand
LC/Param/RadCool.dat	NameFile
ascii			TypeFile

#SAVELOGFILE
T			DoSaveLogfile
RAW                     StringLogfile
1                       DnSaveLogfile
-1.                     DtSaveLogfile

#SAVEPLOT
3
x=0 mhd idl		StringPlot
50			DnSavePlot
-1.0			DtSavePlot
-1.0			DxSavePlot
y=0 mhd idl		StringPlot
50			DnSavePlot
-1.0			DtSavePlot
-1.0			DxSavePlot
z=0 mhd idl		StringPlot
50			DnSavePlot
-1.0			DtSavePlot
-1.0			DxSavePlot

#END_COMP LC ----------------------------------------------------------------

#STOP
200			MaxIteration
-1.0			tSimulationMax

#END
