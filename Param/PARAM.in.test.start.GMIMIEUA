#ECHO
T			DoEcho

#DESCRIPTION
Startup for GM-IM-IE-UA. Solar wind condition based on SC-IH run.

#PLANET
EARTH			NamePlanet

#STARTTIME
1998			iYear
5			iMonth
1			iDay
0			iHour
0			iMinute
0			iSecond
0.0 			FracSecond

#IDEALAXES
! Align rotational and magnetic axes with Z_GSE

#TIMEACCURATE
F			DoTimeAccurate

#SAVERESTART
T			DoSaveRestart
1000			DnSaveRestart
-1.0			DtSaveRestart

! Do not use IM, IE, UA until GM gets a reasonable state
#COMPONENT
IM			NameComp
F			UseComp

#COMPONENT
IE			NameComp
F			UseComp

#COMPONENT
UA			NameComp
F			UseComp
 
#BEGIN_COMP GM ----------------------------------------------------------------

#PROBLEMTYPE
11

#GRID
2			nRootBlockX
1			nRootBlockY
1			nRootBlockZ
-224.                   xMin
 +32.                   xMax
 -64.                   yMin
 +64.                   yMax
 -64.                   zMin
 +64.                   zMax

#AMRINIT
magneto12		TypeRefineInit
4			nRefineLevelInit

#AMR
300			DnRefine
F			DoAutoRefine

#BODY
T			UseBody
2.5			rBody      [rEarth]
3.5			rCurrents  [rEarth]
10.0			BodyRhoDim [amu/cc]
25000.0			BodyTDim   [K]

! This is based on the SC-IH steady state but Bz sign is flipped to northward,
! the temperature is increased to 250000 K and density is decreased so that
! the pressure remains constant.

#SOLARWIND
    11.6                SwRhoDim [amu/cc]
250000.0                SwTDim   [K]
  -461.7                SwUxDim  [km/s]
     0.1                SwUyDim  [km/s]
     0.1                SwUzDim  [km/s]
     1.224              SwBxDim  [nT]
    -0.2                SwByDim  [nT]
    +0.744              SwBzDim  [nT]

#OUTERBOUNDARY
outflow			TypeBcEast
inflow			TypeBcWest
float			TypeBcSouth
float			TypeBcNorth
float			TypeBcBottom
float			TypeBcTop

#TIMESTEPPING
1			nStage
0.8			CflExlp

#SCHEME
1			nOrder
Rusanov			TypeFlux

#SAVELOGFILE
T			DoSaveLogfile
RAW			StringLogfile
1			DnSaveLogfile
-1.			DtSaveLogfile

#SAVEPLOT
2                       nPlotFiles
y=0 MHD idl             StringPlot
1000                      DnSavePlot
-1.			DtSavePlot
-1.			Dx
z=0 MHD idl             StringPlot
1000                      DnSavePlot
-1.			DtSavePlot
-1.			Dx

#END_COMP GM ------------------------------------------------------------------

#STOP
500			MaxIteration
-1.0			tSimulationMax

#RUN   ########################################################################

#BEGIN_COMP GM ---------------------------------------------------------------

#AMR
-1			DnRefine

#SCHEME
2			nOrder
Rusanov			TypeFlux
minmod			TypeLimiter

#END_COMP GM -----------------------------------------------------------------

#STOP
1000			MaxIteration
-1.0			tSimulationMax

#RUN   ########################################################################

! Now switch on all components and start coupling
#COMPONENT
IM			NameComp
T			UseComp

! IM should run less frequently than GM to avoid some instability
! in the coupling
#CYCLE
IM                      NameComp
2                       DnRun

#COMPONENT
IE			NameComp
T			UseComp

#COMPONENT
UA			NameComp
T			UseComp

! This coupling order allows IE to run concurrently with the others
! since it provides data before it would receive it
#COUPLEORDER
7                       nCouple
IE GM                   NameSourceTarget
IE IM                   NameSourceTarget
IE UA			NameSourceTarget
UA IE			NameSourceTarget
GM IE                   NameSourceTarget
GM IM                   NameSourceTarget
IM GM                   NameSourceTarget

#COUPLE2
GM			NameComp1
IE			NameComp2
10                      DnCouple
-1.                     DtCouple

#COUPLE1
IE			NameSource
IM			NameTarget
10                     DnCouple
-1.                     DtCouple

#COUPLE2
UA			NameComp1
IE			NameComp2
10                      DnCouple
-1.                     DtCouple

#COUPLE2
IM			NameComp1
GM			NameComp2
10                      DnCouple
-1.                     DtCouple

#BEGIN_COMP GM ---------------------------------------------------------------

! Ramp up GM pressure at a rate of 1/10th change per time step
#IM
0.1			TauCoupleIm (

! Do an accurate integration of field line volumes
! Refresh 3D ray tracing every 80 steps only (for applying IM pressure)
#RAYTRACE
T                       UseAccurateIntegral
F                       UseAccurateTrace
0.1                     DtRayExchange
80                      DnRaytrace

#END_COMP GM -----------------------------------------------------------------

#BEGIN_COMP IE ---------------------------------------------------------------

#IONOSPHERE
5                       conductance_model
F                       UseFullCurrent
F			UseFakeRegion2
150.0                   f107_flux
0.2                     StarLightPedConductance
0.5                     PolarCapPedConductance

! Save every 20th solve which corresponds to every 200th SWMF iteration
#IE_SAVEPLOT
1			nFile
min idl			StringPlot
20			DnOutput
-1.0			DtOutput

#END_COMP IE -----------------------------------------------------------------

#BEGIN_COMP UA ---------------------------------------------------------------

! Each block has 18x18 lon and lat cells, and we use 4 by 2 blocks
! which corresponsd to a 20 by 10 degrees resolution:

#GRID
4		nLatBlock
2		nLonBlock

#PRESSURE
F		PressureCoordinates
95.0		BaseAlt [km]
500.0		dz [km]

#FORCING
F		UsePressureGradient (logical)
T		UseIonDrag          (logical)
F		UseViscosity        (logical)
F		UseCoriolis         (logical)
F		UseHorAdvection     (logical)
F		UseVerAdvection     (logical)
F		UseVForce           (logical)

#APEX
F		UseApex

#AMIEFILES
SPS
SPS

#F107
150.0
150.0

#HPI
20.0

#KP
2.0

#SOLARWIND
 1.224			SwBxDim  [nT]
-0.2			SwByDim  [nT]
+0.744			SwBzDim  [nT]
461.0			abs(SwUxDim) [km/s]

#DT
10.0			DtDim [s]

#SAVEPLOTS
10
360
2
3DALL
2D

#STRETCH
65.0		! location of minimum grid spacing
0.0		! Amount of stretch 0 (none) to 1 (lots)
1.0		! More control of stretch ( > 1 stretch less < 1 stretch more)

#END_COMP UA   ########################################################

#STOP
3000
-1.

#END

