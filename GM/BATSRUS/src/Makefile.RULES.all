# Syntax: 
# Conditional in Perl syntax using the variables known by Config.pl
# Compilation rules preceeded with a single TAB character.
# Empty line before next conditional.

$OS eq "AIX" and $Compiler eq "xlf90"
	${COMPILE.f90} ${Cflag0} create_soln_blocks.f90

$OS eq "Darwin" and $Compiler eq "xlf90"
	${COMPILE.f90} ${Cflag2} ${SuffixMapf90} project_B.f90
	${COMPILE.f90} ${Cflag2} ${SuffixMapf90} ModNodes.f90
	${COMPILE.f90} ${Cflag2} ${SuffixMapf90} message_pass_nodes.f90

$OS eq "Linux" and $Compiler eq "ifort"
	${COMPILE.f90} ${Cflag1} create_soln_blocks.f90
	${COMPILE.f90} ${Cflag1} get_im_pressure.f90
	${COMPILE.f90} ${Cflag1} set_ICs.f90
	${COMPILE.f90} ${Cflag1} write_logfile.f90

$OS eq "Linux" and $Compiler eq "ifort" and $Equation =~ /Mars|Venus|Titan/i
	${COMPILE.f90} ${Cflag1} impl_jacobian.f90

$OS eq "IRIX64" and $Compiler eq "f90"
	${COMPILE.f90} ${Cflag2} set_outer_BCs.f90

# On some machines NAG f95 -O3/-O4 produced run time error for write_plot_los
$Compiler eq "f95"
	${COMPILE.f90} ${Cflag2} write_plot_los.f90

# The NAG compiler cannot compile big static arrays with the -nan flag
$Compiler eq "f95" and $Debug eq "yes"
	${COMPILE.f90} ${SEARCH} -c -O0 -C -gline ${PRECISION} ModIO.f90

# This user file does not compile with -nan
$Compiler eq "f95" and $Debug eq "yes" and $UserModule =~ /Mars 4 species/i
	${COMPILE.f90} ${SEARCH} -c -O0 -gline ${PRECISION} ModUser.f90

# Do not optimize the implicit source code if only 1 implicit block is allowed
$MaxImplBlock == 1
	${COMPILE.f90}  ${Cflag0} implicit.f90
	${COMPILE.f90}  ${Cflag0} impl_interface.f90
	${COMPILE.f90}  ${Cflag0} impl_jacobian.f90
	${COMPILE.f90}  ${Cflag0} impl_matvec.f90
	${COMPILE.f90}  ${Cflag0} impl_newton.f90

#Special rule to compile HDF5 code
$Hdf5 eq "yes"
	h5pfc ${Cflag2} ModHdf5.f90

$Compiler eq "pgf90"
	${COMPILE.f90}  ${Cflag0} impl_interface.f90
