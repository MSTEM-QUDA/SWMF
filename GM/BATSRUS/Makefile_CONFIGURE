#^CFG COPYRIGHT UM
#^CFG FILE CONFIGURE

#^CFG IF NOT COVARIANT BEGIN
############################################################################

DCART =CARTESIAN
cartesian_src:
	./Configure.pl -keepall -exe=covariant -d=${DCART} -u
	cd CARTESIAN; make install

cartesian_conf: cartesian_src
	cd ..; rm -rf BATSRUS_conf; ln -s BATSRUS/${DCART} BATSRUS_conf

cartesian: cartesian_src

#^CFG END COVARIANT
#^CFG IF COVARIANT BEGIN
############################################################################

DCOV =COVARIANT

covariant_src:
	./Configure.pl -d=${DCOV} -u -off=boriscorr \
		-on=awflux,lindeflux,testing,userfiles,covariant
	cd ${DCOV}; make install

covariant_conf: covariant_src
	cd ..; rm -rf BATSRUS_conf; ln -s BATSRUS/${DCOV} BATSRUS_conf

covariant: covariant_src
	cd ${DCOV}; make

covarcheck_src:
	./Configure.pl -d=COVARCHECK -u -off=boriscorr \
		-on=awflux,lindeflux,testing,userfiles
	cd COVARCHECK; make install

covarcheck_conf: covarcheck_src
	cd ..; rm -rf BATSRUS_conf; ln -s BATSRUS/COVARCHECK BATSRUS_conf

covarcheck: covarcheck_src
	cd COVARCHECK; make


#^CFG END COVARIANT
#^CFG IF GLOBALHELIOSPHERE BEGIN
############################################################################
DGLOBALH=GLOBALHELIOSPHERE
globhelio_src:
	./Configure.pl -d=${DGLOBALH} -keepall -u \
	-off=ionosphere,boriscorr,implicit,roeflux,rcm,covariant \
	-on=globalheliosphere \
	-exe=ionosphere,boriscorr,implicit,roeflux,rcm,globalheliosphere
	cd ${DGLOBALH}; make install; ./Options.pl -e=MhdGlobalHelio

globhelio_conf: globhelio_src
	cd ..; rm -rf BATSRUS_conf; \
	ln -s BATSRUS/${DGLOBALH} BATSRUS_conf

globhelio: globhelio_src
	cd ${DGLOBALH}; make

#^CFG END GLOBALHELIOSPHERE 
#^CFG IF MULTISP BEGIN
############################################################################

multisp_src:
	./Configure.pl -d=MULTISP 
	-off=implicit,ionosphere,rusanovflux,roeflux,awflux,boriscorr \
	-on=multisp,lindeflux,testing,userfiles,covariant \
	cd MULTISP; make install; ./Options.pl -u=Mars -e=MhdMars

multisp_conf: multisp_src
	cd ..; rm -rf BATSRUS_conf; \
	ln -s BATSRUS/MULTISP BATSRUS_conf

multisp: multisp_src
	cd MULTISP; make

#^CFG END MULTISP
#^CFG IF ALWAVES BEGIN
############################################################################
DREL=RELAX
COMP=IH
relax_src:
	./Configure.pl -d=${DREL} -u \
		-on=alwaves,awflux,userfiles,testing \
		-off=rusanovflux,ionosphere,boriscorr,covariant
	cd ${DREL}; rm -f CVS_Entries .cvsignore
	cd ${DREL}/srcInterface; \
		rm -f .cvsignore GM_* ModIeGrid.f90 *bc.f90 *BC.f90
	cd ${DREL}; make install; ./Options.pl -e=MhdCorona -u=Heliosphere; \
		perl -i -pe 's?GM?${COMP}?g' Makefile* Param/PARAM.DEFAULT

relax_conf: relax_src
	cd ..; rm -rf BATSRUS_conf; ln -s BATSRUS/${DREL} BATSRUS_conf

relax: relax_src
	cd ${DREL}; make

#^CFG END ALWAVES
#^CFG IF ALWAVES BEGIN
############################################################################
corelax_src:
	./Configure.pl -d=CORELAX \
		-off=rusanovflux,ionosphere,boriscorr,implicit \
		-on=alwaves,awflux,testing,userfiles,covariant
	cd CORELAX; make install

corelax_conf: corelax_src
	cd ..; rm -rf BATSRUS_conf; \
	ln -s BATSRUS/CORELAX BATSRUS_conf

corelax: corelax_src
	cd CORELAX; make

#^CFG END ALWAVES
